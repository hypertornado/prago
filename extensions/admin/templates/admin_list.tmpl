{{define "admin_list"}}

{{$adminResource := .admin_resource }}
{{$locale := .locale}}

{{$csrfToken := ._csrfToken}}
{{$table := .admin_list}}

{{$global := .}}

{{range $snippet := .admin_resource.Snippets}}
  {{tmpl $snippet.Template $global}}
{{end}}

{{$list := .admin_list}}

<table class="admin_table admin_table-list {{if .admin_list.CanChangeOrder}} admin_table-order{{end}}" data-type="{{.admin_list.TypeID}}" data-order-column="{{.admin_list.OrderColumn}}" data-order-desc="{{.admin_list.OrderDesc}}">
  <thead>
  <tr>
    <td colspan="{{.admin_list.Colspan}}">
      <div class="admin_table_listheader">
        <h2>{{.admin_title}}</h2>

        <div class="btngrp">
        {{range $item := .admin_list.Actions}}
          <a href="{{$item.Url}}" class="btn">{{$item.Name}}</a>
        {{end}}
        </div>
      </div>
    </td>
  </tr>
  <tr>
  {{range $item := .admin_list.Header}}
    <th>
      {{if $item.CanOrder}}
        <a href="#">
      {{- end -}}
        {{- $item.NameHuman -}}
      {{if $item.CanOrder -}}
        </a>
      {{end}}
    </th>
  {{end}}
  <th></th>
  </tr>
  <tr>
    {{range $item := .admin_list.Header}}
      <th>
        {{if $item.CanFilter}}
          <input class="input admin_table_filter_item" data-typ="{{$item.ColumnName}}">
        {{end}}
      </th>
    {{end}}
    <th></th>
  </tr>
  </thead>
  <tbody></tbody>
</table>

{{end}}

{{define "admin_list_cells"}}
{{range $item := .admin_list.Rows}}
  <tr data-id="{{$item.ID}}" class="admin_table_row">
    {{range $cell := $item.Items}}
    <td>
      {{ tmpl $cell.TemplateName $cell }}
    </td>
    {{end}}
    <td nowrap class="center top">
      <div class="btngrp">
        {{range $action := $item.Actions}}
          {{if $action.Url}}
            <a href="{{$action.Url}}" class="btn">{{$action.Name}}</a>
          {{else}}
            <div{{range $k, $v := $action.Params}} {{HTMLAttr $k}}="{{$v}}"{{end}}>{{$action.Name}}</div>
          {{end}}
        {{end}}
      </div>
    </td>
  </tr>
{{end}}
{{if .admin_list.Pagination.Pages}}
  <tr>
    <td colspan="{{.admin_list.Colspan}}" class="pagination">
      {{range $page := .admin_list.Pagination.Pages}}
        {{if $page.Current}}
          <span class="pagination_page pagination_page-current">{{$page.Name}}</span>
        {{else}}
          <a href="{{$page.URL}}" class="pagination_page">{{$page.Name}}</a>
        {{end}}
      {{end}}
    </td>
  </tr>
{{end}}
{{end}}
